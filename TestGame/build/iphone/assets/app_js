function updateVpad(){if(isVpadActive){var e=.2*(touchX-(vpad.x+.5*vpad.width)),a=.2*(touchY-(vpad.y+.5*vpad.height));vpad.color(.78,.78,.78),vpad_nav.x=touchX-.5*vpad_nav.width,vpad_nav.y=touchY-.5*vpad_nav.height,vpad_nav.show(),"RIGHT"==sprite.direction&&0>e?(sprite.direction="LEFT",sprite.animate(8,5,250,-1)):"LEFT"==dog.direction&&e>0&&(dog.direction="RIGHT",dog.animate(0,2,250,-1));var i=sprite.x+e,t=sprite.y+a,p=map.x-e,n=map.y-a;i>0&&i<game.screen.width-sprite.width?sprite.x=i:0>=p&&p>-map.width+game.screen.width&&(map.x=p,map_items.x=map.x),nextpriteY>0&&t<game.screen.height-sprite.height?sprite.y=t:0>=n&&n>-map.height+game.screen.height&&(map.y=n,map_items.y=map.y)}else vpad.color(1,1,1),vpad_nav.hide()}var window=Ti.UI.createWindow({backgroundColor:"black"}),platino=require("co.lanica.platino"),game=platino.createGameView();game.fps=30,game.color(0,0,0),game.debug=!0;var scene=platino.createScene(),GRAPHICS_DIR="assets/",sprite=platino.createSpriteSheet({image:GRAPHICS_DIR+"Jughead/Jughead_walking.png",width:220,height:220});scene.add(sprite);for(var mapfile=Ti.Filesystem.getFile(Titanium.Filesystem.resourcesDirectory,GRAPHICS_DIR+"Jungle.json"),mapjson=JSON.parse(mapfile.read().toString()),i=0;i<mapjson.length;i++)var mapinfo={image:GRAPHICS_DIR+mapjson.tilesets[i].image,tileWidth:mapjson.tilesets[i].tilewidth,tileHeight:mapjson.tilesets[i].tileheight,border:mapjson.tilesets[i].spacing,margin:mapjson.tilesets[i].margin};console.log(mapinfo);var map=platino.createMapSprite(mapinfo);map.width=map.tileWidth*mapjson.layers[0].width,map.height=map.tileHeight*mapjson.layers[0].height,map.firstgid=mapjson.tilesets[0].firstgid,map.tiles=mapjson.layers[0].data;var vpad=platino.createSprite({image:GRAPHICS_DIR+"control_base.png"}),vpad_nav=platino.createSprite({image:GRAPHICS_DIR+"particle.png"});vpad_nav.hide(),vpad_nav.color(1,1,0),vpad.alpha=.5,map.z=0,sprite.z=2,vpad.z=3,vpad_nav.z=4;var WINDOW_SCALE_FACTOR_X=1,WINDOW_SCALE_FACTOR_Y=1,isVpadActive=!1,touchX,touchY,updateVpadTimerID=0;game.addEventListener("onload",function(){var e=game.size.width/320;game.screen={width:game.size.width/e,height:game.size.height/e},Ti.API.info("view size: "+game.size.width+"x"+game.size.height),Ti.API.info("game screen size: "+game.screen.width+"x"+game.screen.height),Ti.API.info("map: "+map.width+"x"+map.height),WINDOW_SCALE_FACTOR_X=game.screen.width/game.size.width,WINDOW_SCALE_FACTOR_Y=game.screen.height/game.size.height,vpad.x=.5*game.screen.width-.5*vpad.width,vpad.y=game.screen.height-vpad.height,game.start(),sprite.direction="RIGHT",sprite.animate(0,8,100,-1),updateVpadTimerID=setInterval(function(){updateVpad()},66)}),window.addEventListener("android:back",function(){clearInterval(updateVpadTimerID),window.close()}),Ti.include("debug.js"),scene.add(sprite),scene.add(map),scene.add(vpad),scene.add(vpad_nav),game.pushScene(scene),window.add(game),window.open({fullscreen:!0,navBarHidden:!0});